# Topic : An Analysis of Food Security in USA - 2021

***

#### Our team’s research topic is the situation of food security in 2021.  We want to know how different demographic and socioeconomic factors relate to food security. 

*We are using the Current Population Survey - Food Security Supplement Dec 2021 data provided by the US Census Bureau*

*The Dataset contains 507 variables and roughly 120,000 observations*

*** 

##### The Smart Question we have proposed and hope to answer are

**Specific**:- To study the specific pattern shown in the data that affects food security such as states, counties, income level, whether the family uses SNAP, race, immigrant status, work status, education level and many more demographic, socio-economic variables.  

**Measurable**: Use EDA techniques to know how significantly different factors contribute to food insecurity.  

**Achievable**: Can find variables which are significantly affecting food insecurity and can create models for ensuring food security in households.  

**Relevant**: Food being the basic requirement of any human, this study can shed light on what the authorities and we ourselves can do in order to eradicate food insecurity.  

**Time-oriented**: Data set for the month of December 2021 is considered for the study so that it can also show the effect of Covid-19 in food security.  

*** 

*Considering the Questions we are asking, we have decided to select just 11 factors to work on* 

*A very significant limitation to our data is that we have trimmed off a lot of observations where either the interview was not taken or not completed.  Ideally we should account for these observations somehow, but due to time constraints we aren't doing that*


***


```{r, echo=FALSE, cache=TRUE }
Food_Sec <- data.frame(read.csv("dec21pub.csv"))
```

  

```{r, echo=FALSE, results='hide', message=FALSE}
library(dplyr)
library(ezids)
library(ggplot2)
library(epiR)

```

```{r, results='markup', echo=FALSE}


FS_Subset <- subset(Food_Sec, HRINTSTA == 001 & HRSUPINT == 001 & HRFS12MD != -9)
FS_Subset <- subset(FS_Subset, select = c("HRHHID",	"GESTFIPS",	"HRNUMHOU",	"HEFAMINC",	"HESP1",	"PTDTRACE",	"PRCITSHP",	"PEMJNUM",	"PEHRUSL1",	"PEEDUCA", "HRFS12MD", "PRNMCHLD"))

FS_Subset <- FS_Subset %>% rename("Id" = "HRHHID", "States" = "GESTFIPS", "Family_Size" = "HRNUMHOU",	"Household_Income" = "HEFAMINC",	"SNAP" = "HESP1",	"Ethnicity" =	"PTDTRACE", "Citizenship_status" = "PRCITSHP",	"Number_of_Jobs" = "PEMJNUM",	"Hours_on_Jobs" = "PEHRUSL1" , "Education_Level" = "PEEDUCA" , "FoodSecurity_score" = "HRFS12MD")

## Converting the all the columns to factors as they are all ordinal(except the Id, but since it's categorical i'm converting it into a factor too)


FS_Subset[] <- lapply( FS_Subset, factor)

str(FS_Subset)
```


**Coming to our Response Variable, Food Security** 

***
  
**High Food Security**:  No reported indications of food-access problems or limitations.


**Marginal Food Security**:  One or two reported signs, usually anxiety over food availability or scarcity in the home. There is little to no evidence that diets or food intake have changed.  

**Low Food Security**:  One or two reported signs, usually indicating worry about food scarcity or insufficiency at home. Little to no evidence of dietary or food intake changes.  

**Very Low Food Security**:  Reports of numerous signs of altered eating habits and decreased food intake.  

***

```{r, results='markup', echo=FALSE, results='hide'}
levels(FS_Subset$'FoodSecurity_score') <- c( "High Food Security", "Marginal Food Security", "Low Food Security", "Very Low Food Security")
summary(FS_Subset$'FoodSecurity_score')


FS_Subset$FS_Status <- FS_Subset$FoodSecurity_score

levels(FS_Subset$FS_Status) <- c( "Food Secure", "Food Secure", "Food Insecure", "Food Insecure")
```





```{r, results='markup', echo=FALSE, out.width="49%", out.height="20%",fig.cap="caption",fig.show='hold',fig.align='center'}
ggplot(FS_Subset, aes(x= FoodSecurity_score,  y = ..prop.., group = 1)) + geom_bar( fill = "blue") +  geom_text(aes(label = round((..prop..), 2)), stat = "count", hjust = 0, colour = "black") + coord_flip()  + labs(x= " ", y= "Relative Frequency ") +  scale_y_continuous(limits = c(0, 1))
df <- FS_Subset %>% 
  group_by(FS_Status) %>% # Variable to be transformed
  count() %>% 
  ungroup() %>% 
  mutate(perc = `n` / sum(`n`)) %>% 
  arrange(perc) %>%
  mutate(labels = scales::percent(perc))

ggplot(df, aes(x = "", y = perc, fill = FS_Status)) +
  geom_col() +
    geom_text(aes(label = labels),
            position = position_stack(vjust = 0.5)) +
  coord_polar(theta = "y") + labs(x= " ", y= " ")



```


```{r, results='markup', echo=FALSE, results='hide'}
levels(FS_Subset$'Ethnicity') <- c('White only', 'Black only', 'American Indian, Alaskan native only', 'Asian Only', 'Hawaiian', 'White-black', 'White-AI', 'White-Asian', 'White-HP', 'Black-AI', 'Black-Asian', 'Black-HP', 'AI-Asian', 'AI-HP', 'Asian-HP', 'W-B-AI', 'W-B-A', 'W-B-HP', 'W-AI-A', 'W-AI-HP', 'W-A-HP', 'B-AI-A', 'W-B-AL-A', 'W-AI-A-HP', 'Other 3 race combo', 'Other 4 and 5 race combo')
summary(FS_Subset$'Ethnicity', title = "PTDTRACE")

summary(FS_Subset$'SNAP', title = "HESP1")

levels(FS_Subset$'Citizenship_status') <- c('NATIVE, BORN IN THE UNITED STATES', 'NATIVE, BORN IN PUERTO RICO OR OTHER U.S. ISLAND AREAS', 'NATIVE, BORN ABROAD OF AMERICAN PARENT OR PARENTS', 'FOREIGN BORN, U.S. CITIZEN BY NATURALIZATION', 'FOREIGN BORN, NOT A CITIZEN OF THE UNITED STATES')
summary(FS_Subset$'Citizenship_status', title = "PRCITSHP")


```

### Ethnicity

***

* We have 25 Ethnicities in this Data. We will explore the relationship between Ethnicity and Food Security graphically, and do some statistical testing to confrim the said relationship

***

##### Plotting barcharts between all types of Ethinicity and food security status

```{r, results='markup', echo=FALSE, out.width="49%", out.height="20%",fig.cap="caption",fig.show='hold',fig.align='center'}


FS_Subset$Ethnicity <- droplevels(FS_Subset$Ethnicity)

for(i in levels(FS_Subset$Ethnicity)){
   
  print(ggplot(subset(FS_Subset, Ethnicity == i ) , aes(x= Ethnicity, color =FS_Status, fill = FS_Status)) + geom_bar( aes(y = (..count..)/sum(..count..)*100), position = "dodge") + labs(x= " ", y= "Percentage "))

}
```
#### Statistical Testing

***

* We are going to be Using Fisher’s Exact Test instead of Chi-square test because of the numerous levels with low frequency of observations

* Our Null Hypothesis is that Ethnicity and Food Security Status are Independent of each other.

* Taking our alpha to be 5%


***

```{r, results='markup', echo=FALSE}


fisher.test(FS_Subset$Ethnicity, FS_Subset$FoodSecurity_score, simulate.p.value=TRUE)

```

***

* Since, the P-Value is less than our taken alpha we can say that there is a statistically significant relationship between Ethnicity and Food Security

***


### Citizenship

***

* We have 5 levels of Citizenship status in this Data. We will explore the relationship between Citizenship and Food Security graphically, and do some statistical testing to confrim the said relationship

***

##### Plotting barcharts between different Citizenship status's and food security status

```{r, results='markup', echo=FALSE, out.width="49%", out.height="20%",fig.cap="caption",fig.show='hold',fig.align='center'}

for(i in levels(FS_Subset$Citizenship_status)){
   
  print(ggplot(subset(FS_Subset, Citizenship_status == i ) , aes(x= Citizenship_status, color =FS_Status, fill = FS_Status)) + geom_bar( aes(y = (..count..)/sum(..count..)*100), position = "dodge")+ labs(x= " ", y= "Percentage "))
}




```


#### Statistical Testing

***

* We are Chi-square test

* Our Null Hypothesis is that Citizenship Status and Food Security Status are Independent of each other.

* Taking our alpha to be 5%


***

```{r, results='markup', echo=FALSE}
chisq.test(FS_Subset$Citizenship_status, FS_Subset$FoodSecurity_score)
```


***

* Since, the P-Value is less than our taken alpha we can say that there is a statistically significant relationship between Citizenship Status and Food Security

***

### SNAP

***

* SNAP Stands for Supplemental Nutrition Assistance Program
* SNAP factor had 5 levels to in this dataset
* We have dropped a level which indicated that the observations are not in universe

***

##### Plotting Stacked barcharts between SNAP status and food security status

```{r, results='markup', echo=FALSE, out.width="49%", out.height="20%",fig.cap="caption",fig.show='hold',fig.align='center'}



## Only would be considering the levels 1 and 2. here -1, the one with most frequency, means that the response is not in universe. Ideally, I should substitute this but due to time constraints I won't be doing that. -3 and -2 mean refuse to respond and no response.


FS_SNAP <- subset(FS_Subset, FS_Subset$SNAP != -1)
FS_SNAP <- droplevels(FS_SNAP)

levels(FS_SNAP$SNAP) <- c('Refused', 'Dont Know', 'Uses SNAP', 'No SNAP')



ggplot(FS_SNAP, aes(x = SNAP, fill = FoodSecurity_score)) + geom_bar(position = "fill") + labs( x = " " , y = " ")
ggplot(FS_SNAP, aes(x = SNAP, fill = FS_Status)) + geom_bar(position = "fill") + labs( x = " " ,y = " ")
```

#### Statistical Testing

***

* We are Chi-square test

* Our Null Hypothesis is that SNAP Status and Food Security Status are Independent of each other.

* Taking our alpha to be 5%


***


```{r, results='markup', echo=FALSE}
chi_test_SNAP <- table(FS_SNAP$SNAP, FS_SNAP$FS_Status)


chisq.test(chi_test_SNAP)

```
***

* Since, the P-Value is less than our taken alpha we can say that there is a statistically significant relationship between SNAP Status and Food Security

***


#### Odds Ratio

```{r,results = 'markup', echo=FALSE}
SNAP_Odds <- droplevels(subset(FS_SNAP, SNAP != "Refused" & SNAP != "Dont Know"))

TAB <- table(SNAP_Odds$SNAP, SNAP_Odds$FS_Status)


barplot(TAB, beside= T, legend = T)

epi.2by2(TAB, method = "cohort.count")
```
***

* The Odds ratio is 0.46, with a 95% Confidence Interval
* This means that the odds of a person not on SNAP to be food secure is 2.17 times the odds of person on SNAP to be food secure.



***

Now to conduct a study on the basis of ***Number of Jobs they do***, ***Education Level*** and ***Hours on work per week*** we create another dataset and move forward with the analysis.

```{r data_ave, results='markup', echo=FALSE}
food_ave <- subset(FS_Subset, select = c("Id",	"Number_of_Jobs",	"Hours_on_Jobs",	"Education_Level", "FoodSecurity_score"))
head(food_ave)
str(food_ave)
```

Now we rename the responses of the variable as per mentioned in the technical file of this data. 
```{r, results='markup', echo=FALSE}
levels(food_ave$Education_Level) <- c('Not Applicable','Less Than 1st Grade', '1st, 2nd, 3rd Or 4th Grade','5th Or 6th Grade', '7th Or 8th Grade', '9th Grade', '10th Grade', '11th Grade', '12th Grade No Diploma', 'High School Grad-Diploma Or Equiv (Ged)', 'Some College But No Degree', 'Associate Degree-Occupational/Vocational', 'Associate Degree-Academic Program', 'Bachelors Degree','Masters Degree', 'Professional School Deg' , 'Doctorate Degree')
```

The summary of the education level of respondents is as follows: 

```{r, echo=FALSE, results='markup'}
summary(food_ave$Education_Level, title = "PEEDUCA")
```

The summary of the number of jobs of the respondents is as follows:

```{r, echo=FALSE,results='markup'}
levels(food_ave$Number_of_Jobs) <- c('Not Applicable', '2 Jobs', '3 Jobs', '4 or more jobs')
summary(food_ave$Number_of_Jobs, title = "PEMJNUM")
```


```{r factor, results='markup', echo=FALSE}
food_ave$Number_of_Jobs = as.factor(food_ave$Number_of_Jobs)
food_ave$Education_Level = as.factor(food_ave$Education_Level)
food_ave$FoodSecurity_score = as.factor(food_ave$FoodSecurity_score)
food_ave$Hours_on_Jobs = as.numeric(food_ave$Hours_on_Jobs)
```

### Number of Jobs

Now we conduct an in-depth EDA on the **Number of Jobs of the respondents**
```{r no_of_jobs, results='markup', echo=FALSE}
plot(food_ave$Number_of_Jobs)
ggplot(food_ave) +
  geom_bar(aes(x = Number_of_Jobs, fill = FoodSecurity_score), position = "dodge") +
  xlab("Jobs") + ylab("Count")
```
The above graph shows a result where majority of the respondents doesn't fall under the category of eligible to answer this question. And hence their response is marked as **Not Applicable**.

This hides the proper analysis of the responses. Hence we remove the Not Applicable responses from the variable and move forward with the study.

```{r, results='markup', echo=FALSE}
food_noj <- subset(food_ave, food_ave$Number_of_Jobs != 'Not Applicable')
ggplot(food_noj, aes(x = Number_of_Jobs, fill = FoodSecurity_score)) + geom_bar(position = "fill") + labs( x = " " , y = " ", title = "Food Security Score on Number of Jobs")
```



```{r, results='markup', echo=FALSE}

ggplot(subset(food_ave, Number_of_Jobs == '2 Jobs' )) +
  geom_bar(aes(x = Number_of_Jobs, fill = FoodSecurity_score), position = "dodge") +
  xlab("Number of Jobs") + ylab("Count")

ggplot(subset(food_ave, Number_of_Jobs == '3 Jobs')) +
  geom_bar(aes(x = Number_of_Jobs, fill = FoodSecurity_score), position = "dodge") +
  xlab("Number of Jobs") + ylab("Count")

ggplot(subset(food_ave, Number_of_Jobs == '4 or more jobs')) +
  geom_bar(aes(x = Number_of_Jobs, fill = FoodSecurity_score), position = "dodge") +
  xlab("Number of Jobs") + ylab("Count")
```

The above graphs clearly gives us an understanding about how many people in different categories of the variable have different food security scores.

Though it is evident that the majority of the responses irrespective of the number of jobs are saying they are Highly Food Secure, people who have 4 or more jobs have a very evident number of food insecure people. But still whether they have any dependency or not needs to be analyzed using proper statistical tests. For this we bring in the Chi- square test.


```{r, results='markup', echo=FALSE}
food_num <- droplevels(subset(food_ave, Number_of_Jobs != "Not Applicable" ))
str(food_num)
```


```{r, results='markup',warning=FALSE, echo=FALSE}
contable_number_of_jobs <- table(food_num$Number_of_Jobs, food_num$FoodSecurity_score)
xkabledply(contable_number_of_jobs)

## Chi-Square Test 
chi_test <- chisq.test(contable_number_of_jobs, correct = F)
chi_test
```

The result gave warnings as the value for some cells in contigency table are very low.
From the test, we see that the P-value for the Chi-square test is **0.3871** which is greater than the default value 0.05. Hence we accept the null hypothesis and hence, Number of Jobs doesn't significantly affect the Food Security.

The test showed that, though there is variance in the proportion in graph, there is no dependency of these two vaiables.

###Education Level

The level of education is very important. We always assume that education is a powerful tool to eradicate poverty and hunger. With the assumption that this is true in case for food security, we shall dive into the EDA analysis of the variable. The variable had many responses. 

The initial setup was done on the data by removing the "Not Applicable" responses from the data as per the instruction from the technical data.

```{r, echo=FALSE}
food_edu <- droplevels(subset(food_ave, Education_Level != "Not Applicable" ))
```

Since the responses were in many categories, it is good to look into their frequency table.
```{r, echo=FALSE, results='markup'}
edu_freq <- as.data.frame(table(food_edu$Education_Level))
edu_freq
```
The frequency table gave us an outline about the sample we are using. Most of the people in the survey are educated to High School or above. This is very promising about the overall growth of the society and a hope for better future.

Now even though the frequency table showed us with a majority educated sample, the food security score of the people still need to be studied. The initial tool that we can use for this study is graphical representation.

```{r , results='markup', echo=FALSE}
plot(food_edu$Education_Level)
ggplot(food_edu) +
  geom_bar(aes(x = Education_Level, fill = FoodSecurity_score), position = "dodge") +
  xlab("Jobs") + ylab("Count")

ggplot(food_edu, aes(x = Education_Level, fill = FoodSecurity_score)) + geom_bar(position = "fill") + labs( x = " " , y = " ", title = "Food Security Score on Education Level")
```
These three graphs gives us a perfect picture of the sample in this variable. Initial graph shows the fact that major proportion of the population belongs to a category of High school education or more. The next two graphs shows us the division of the category in terms of food security score. Though major ratio goes for high food security, we can clearly see a picture of decreasing low food security scored people as the education level increase. 

But this hypothesis needs to be supported by appropriate statistical tests. Since the data variables under study are both catgorical, we use Chi-Square test to test the independence of the variables. 

The Chi-Square test results are as follows:

```{r, results='markup', warning=FALSE, echo=FALSE}
contable_edu <- table(food_ave$Education_Level, food_ave$FoodSecurity_score)
xkabledply(contable_edu)

## Chi-Square Test 
chi_test <- chisq.test(contable_edu, correct = F)
chi_test
```

The test results showed that p-value is less than 0.05, the default alpha value and hence we can say that `Education_Level` is having a significant effect on the Food Security of People. This is such an important factor to keep in mind as giving people more education can actually act as a solution gives us with a better hope. Majority of the population being educated or will be educated makes this variable as important as anything.

##Hours_on_Jobs

The Hours on Job for a week vary from people to people. How they food security score had an effect on hours on job is studied in the following EDA analysis.

There were few people who gave response as time varies and they don't have a perfect time period, gave responses in the study. But inorder to meet the hypothesis of the test and easy analysis, those responses were removed. Removing those responses made the variable continuous and the acceptable range of responses were 0 to 99.


```{r, results='markup', echo=FALSE}
food_hoj <- droplevels(subset(food_ave, Hours_on_Jobs != -4 ))
hoj_freq <- as.data.frame(table(food_ave$Hours_on_Jobs))
summary(food_ave$Hours_on_Jobs)

getmode <- function(v) {
   uniqv <- unique(v)
   uniqv[which.max(tabulate(match(v, uniqv)))]
}
getmode(food_ave$Hours_on_Jobs)
hoj_freq
```

The above results shows that the range of responses were between 1 and 88. Though the average hours of work is around 20 Hours, it is surprising to learn that majority of the responses said they work for 2 hours. This needs to be further verfied and studied as this trend can't be encouraged. But also the possible reason why the mode came to be 2 Hours per week can also be because, the respondents were students. Further study needs to be extended on this.


```{r, results='markup', echo=FALSE}
ggplot(food_hoj, aes(Hours_on_Jobs, fill = FoodSecurity_score)) + 
        geom_histogram(binwidth=5)
ggplot(food_hoj, aes(Hours_on_Jobs)) + 
        geom_freqpoly(binwidth=1)
ggplot(food_hoj, aes(Hours_on_Jobs, color= FoodSecurity_score)) + 
        geom_freqpoly(binwidth=25)
ggplot(food_hoj, aes(Hours_on_Jobs, fill = FoodSecurity_score)) + 
        geom_histogram(binwidth=5) + 
        facet_wrap(~FoodSecurity_score)
```

The above graphs clearly depicts the distribution of data on this variable.

The following is a bargraph for the same variable.
```{r,results='markup',echo=FALSE}
ggplot(food_hoj, aes(x=FoodSecurity_score, y=Hours_on_Jobs)) + 
  geom_boxplot( colour=c("blue","violet","navy blue","black"), outlier.shape=8, outlier.size=4) +
  labs(title="Boxplot for Hours on Jobs", x="Control / Treatment", y = "Hours on Job")
```
From the bargraph, we can see that, though the boxes lie around the same region, few of the classes have very evident difference. This needs to be checked. Whether food security score affects the hours on job can be studied using ANOVA test and our hypothesis is verified by this statistical test.
Further on the Post-Hoc test verifies which groups have differences.

```{r, results='markup', warning=FALSE, echo=FALSE}
h_anova <- aov(Hours_on_Jobs ~ FoodSecurity_score, data = food_hoj)
h_tuskey <- TukeyHSD(h_anova)
summary(h_anova)
h_tuskey
```

From the results, it is very clear that the greater F value and smaller P value gives us enough confidence to say that the Hours of work changes significantly with the Food Security Score. Now using Post-Hoc test, it is confirmed that, Marginal Food Security-High Food Security, Low Food Security-High Food Security, Very Low Food Security-High Food Security is significantly different from the other. Also, Low Food Security-Marginal Food Security, Very Low Food Security-Marginal Food Security have significant difference but not as strong as the prior ones. 
These test results help us to say that Hours on Job per week is affected by the Food insecurity that they face.


>>>>>>> 8657d5728a00f036f19d3ba04f8e0d67a4b3431f


-***States, Family size, and Household Income***

```{r, results='markup', echo=FALSE}
levels(FS_Subset$'States') <- c('AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DE', 'DC', 'FL', 'GA', 'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD', 'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ', 'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC', 'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY' )
summary(FS_Subset$'States', title = "GESTFIPS")

```

California has the highest number of respondents (6975), whereas Maine has the smallest number of respondents (564). 
In order to compare, I'm choosing states which has similar number of respondents. 
Alabama 1207 and Washington DC 1207, Florida 2738 and New York 2580, IL 2052 and PA 1928. 

## Plotting barcharts between all the levels of state and food security status

```{r, results='markup', echo=FALSE}
for(i in levels(FS_Subset$States)){
   
  print(ggplot(subset(FS_Subset, States == i ) , aes(x= States, color =FoodSecurity_score, fill = FoodSecurity_score)) + geom_bar( aes(y = (..count..)/sum(..count..)*100), position = "dodge"))
}
```


```{r, results='markup', echo=FALSE}
library(ggplot2)
#qqplot(food_una$States, food_una$FoodSecurity_score, plot.it = TRUE,  xlab="States", ylab="Food security Score",  main="QQ Plot for Food security vs States")

```
<<<<<<< HEAD



```{r, results='markup', echo=FALSE}
#food_una <- subset(FS_Subset, select = c("HRHHID",	"GESTFIPS", "HRNUMHOU",	"HEFAMINC", "HRFS12MD"))
food_una <- subset(FS_Subset, select = c("Id", "States","Family_Size","Household_Income","FoodSecurity_score", "PRNMCHLD"))
head(food_una)

```

Reference to household income: 
1 LESS THAN $5,000  
2 5,000 TO 7,499  
3 7,500 TO 9,999  
4 10,000 TO 12,499  
5 12,500 TO 14,999  
6 15,000 TO 19,999  
7 20,000 TO 24,999  
8 25,000 TO 29,999  
9 30,000 TO 34,999  
10 35,000 TO 39,999  
11 40,000 TO 49,999  
12 50,000 TO 59,999  
13 60,000 TO 74,999  
14 75,000 TO 99,999  
15 100,000 TO 149,999  
16 150,000 OR MORE  

```{r, echo=FALSE}
income_t <- table(FS_Subset$Household_Income, FS_Subset$FoodSecurity_score)
chisq.test(income_t)
```
We can say that Household income is affecting food insecurity. 

```{r, echo=FALSE}
family_t <- table(FS_Subset$Family_Size, FS_Subset$FoodSecurity_score)
chisq.test(family_t)
```
We can say that Family size is affecting food insecurity. 

```{r, results='markup', echo=FALSE}

boxplot(FoodSecurity_score ~ Family_Size, data = food_una, col=c("blue", "red", "green", "yellow", "purple", "orange"), main="Family size - Food security")
boxplot(FoodSecurity_score ~ Household_Income, data = food_una, col=c("blue", "red", "green", "yellow", "purple", "orange"), main="Household Income - Food security")
boxplot(FoodSecurity_score ~ States, data = food_una, col=c("blue", "red", "green", "yellow", "purple", "orange"))

```
As you can see from the boxplot, whenever family size bigger (more than 6 people), food insecurity is high. 
Also, household income has direct effect on food security. When household income is higher than 40k, food security score is low. 

```{r, results='markup', echo=FALSE}
library(ggplot2)
qqplot(food_una$Household_Income, food_una$FoodSecurity_score, plot.it = TRUE,  xlab="Household income", ylab="Food security Score",  col=food_una$Household_Income, main="QQ Plot for Food security vs Household income")

```

```{r, results='markup', echo=FALSE}
summary(FS_Subset$Family_Size)

```


```{r, results='markup', echo=FALSE}
library(ggplot2)
qqplot(food_una$Family_Size, food_una$FoodSecurity_score, plot.it = TRUE,  xlab="Family size", ylab="Food security Score",  col=food_una$Family_Size, main="QQ Plot for Food security vs Family")

```
```{r data_una, results='markup', echo=FALSE}

ggplot(data=food_una, mapping = aes(x = Family_Size, y = FoodSecurity_score)) + 
  geom_point(size=5)+aes(color = Family_Size) +
  theme_bw()

```

```{r, results='markup', echo=FALSE}

ggplot(data=food_una, mapping = aes(x = Family_Size, y = FoodSecurity_score)) + 
  geom_point(size=5)+aes(color = Household_Income) +
  theme_bw()

```


